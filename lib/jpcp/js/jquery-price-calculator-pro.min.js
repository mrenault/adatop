(function(a){var b=function(a,b){this.assets={priceTag:'<span class="price-tag-wrapper"> - <span class="price-tag"></span></span>',sidebar:{total:'<div class="total well"><h3>Total: <span class="price"></span></h3></div>',summary:'<div class="summary well"><h3>Summary:</h3><div class="itemized-summary"/></div>',config:'<div class="config well"/>'}};this.elem=a;this.init(b)};b.prototype={version:"1.5.2",init:function(b){var c=this;c.events={};c.options=a.extend({},a.fn.jPrice.defaults,b);c.addSidebar();c.inputs=c.getInputs();c.addPriceTags();c.initializeSpecialElements();c.addHiddenTotal();c.setupPricesOverPeriod();c.bindEvents();c.addUserConfig();c.onChange()},trigger:function(b,c){if(!this.events[b]){return}var d=this;var e={type:b,data:c};a.each(this.events[b],function(a,b){b.call(d,e)})},on:function(a,b){this.events[a]=this.events[a]||[];this.events[a].push(b)},initializeSpecialElements:function(){var b=this;this.getQuantityElements().each(function(c){var d=a(this);var e={min:1,value:d.val(),step:1};b.instantiateSpinner(d,e)});this.inputs.filter("[data-slider], [data-spinner]").each(function(c){var d=a(this);var e=["min","max","step","value"];var f={};if(typeof g!=="undefined"){g=g.replace(/\\n/g,",");tmp=g.split(",");g={};a.each(tmp,function(a,b){tmp2=b.split(":");g["v"+tmp2[0]]=tmp2[1]})}a.each(e,function(a,b){f[b]=parseFloat(d.attr(b),10)});if(d.is("[data-slider]")){var g=d.data("value-table");var h=a('<div class="slider"/>');h.insertBefore(d);if(typeof g!=="undefined"){}f.slide=function(a,b){var c=b.value;if(typeof g!=="undefined"){c=g["v"+c]}d.val(c).trigger("change")};h.slider(f);if(typeof g!=="undefined"){d.val(g["v"+f.value])}d.on("change click",function(a){h.slider("value",d.val())});d.removeAttr("data-slider");b.instantiateSpinner(d,f)}else{b.instantiateSpinner(d,f)}})},instantiateSpinner:function(b,c){b.removeAttr("data-spinner");if(a.browser.webkit){return}if(typeof b.spinner==="function"){b.prop("type","text");b.spinner(c)}},setupPricesOverPeriod:function(){var b=this.options.pricesOverPeriod;if(!b.length){return}var c=this;var d=this.sidebar_elem.children(".total");a.map(b,function(b,c){var e="<p><strong>"+b.title+': </strong><span class="price-over">'+"</span></p>";b.elem=a(e);b.priceElem=b.elem.find(".price-over");if(b.divider){b.multiplier=1/b.divider}b.elem.appendTo(d);return b});this.on("change",function(d){var e=d.data.total;a.each(b,function(a,b){var d=c.formatPrice(e*b.multiplier)+b.suffix;b.priceElem.text(d)})})},addHiddenTotal:function(){var b=this;var c=a('<input type="hidden" id="total-cost" name="total-cost" />');c.appendTo(this.sidebar_elem.children(".total"));this.on("change",function(a){var b=a.data.total;c.val(b)})},bindEvents:function(){var a=this;var b=function(){a.onChange()};a.elem.on("change","input, select",b);a.elem.on("click",'input[type="number"]',b)},addPriceTags:function(){var b=this;this.elem.find("span.staticPrice").remove();b.inputs.each(function(c,d){var e=a(this);if(e.is("[data-cost]")||e.is("select:has([data-cost])")){b.addPriceTag(e)}})},addUserConfig:function(){var b=this.options;var c=a();var d=this;if(b.showPricesOption){var e=a('<label class="checkbox"><input name="jprice-config" type="checkbox"'+(b.showPrices?' checked="checked"':"")+" /> Show Prices</label>");c=c.add(e);this.sidebar_elem.on("change",'[name="jprice-config"]',function(b){var c=a(this);var e=d.getAllPriceTags();e.fadeTo(d.options.pricesFadeTime,c.is(":checked")?1:0)})}var f=d.getAllPriceTags();f.fadeTo(0,b.showPrices?1:0);var g=this.sidebar_elem.children(".config");if(c.length===0){g.remove()}else{g.append(c)}},getAllPriceTags:function(){return this.options_elem.find(".price-tag-wrapper")},onChange:function(){this.inputs=this.getInputs();this.updatePriceTags();var a=this.calculateTotal();var b=this.formatPrice(a);this.sidebar_elem.children(".total").find(".price").text(b);var c=this.getItemizedSummary();var d=this.renderItemizedSummary(c);this.sidebar_elem.find(".itemized-summary").html(d);var e={total:a,formattedTotal:b};this.trigger("change",e)},updatePriceTags:function(){var b=this;this.inputs.each(function(c){var d=a(this);var e=d.data("price-tag");if(e){var f=b.getPrice(d);if(f===0){var g=b.options.showZeroAs;if(!g||g==="false"){f=""}else{f=g}}if(f){if(!isNaN(f)){f=b.formatPrice(f)}e.show()}else{e.hide()}e.find(".price-tag").text(f)}})},getInputs:function(){var a=this.options_elem.find(":input");a=a.not("[data-ignore]");a=a.not(":submit");return a},getItemizedSummary:function(){var b=this;var c={};this.getSelectedElements().not("textarea").each(function(d){var e=a(this);var f=e.attr("name");if(typeof c[f]==="undefined"){c[f]=[]}var g=b.getInputValue(e);if(g){if(a.isArray(g)){a.merge(c[f],g)}else{c[f].push(g)}}});return c},renderItemizedSummary:function(b){var c=[];var d=this;var e="<hr/>";a.each(b,function(b,f){var g=a("#"+b);var h=g.is("[data-quantity]");var i=d.options.items[b];if(!i){return true}var j="<p><strong>"+i+": </strong>";if(f.length===0){return true}else if(f.length===1){j+=f[0]}else{j+="<ul><li>"+f.join("</li><li>")+"</li></ul>"}j+="</p>";if(h){j='<div class="quantity">'+j+"</div>"}else{j='<div class="line-item">'+j+"</div>"}c.push(j);if(h){c.push(e)}});if(c.length===0){c=[d.options.emptySummaryText]}if(c[c.length-1]===e){c.pop()}return c.join("\n")},formatPrice:function(a){return this.options.signBefore+a.toFixed(2)+this.options.signAfter},addPriceTag:function(b){var c=a(this.assets.priceTag);var d=this.getPrice(b);var e=this.formatPrice(d);c.find(".price-tag").text(e);c.appendTo(b.parent());b.data("price-tag",c)},getInputValue:function(a){var b=a.val();if(a.is(":file")){var c=b.split("\\");return c[c.length-1]}return b},getInputLabel:function(a){if(a.is("[data-label]")){return a.data("label")}return a.parent().find(".input-label").text()},getPrice:function(b){var c=b.is("select");if(c){b=b.find(":selected")}var d=0;b.each(function(b){var c=a(this);var e=parseFloat(c.data("cost")||0,10);if(isNaN(e)){e=0}var f=c.attr("type")||"";if(f.match(/text|number/)){e*=parseFloat(c.val(),10)||0}d+=e});return d},addSidebar:function(){var b=this;var c=a('<div class="sidebar"/>');if(!this.options.itemize){delete this.assets.sidebar.summary}a.each(this.assets.sidebar,function(a,b){c.append(b)});this.elem.wrapInner('<div class="options"/>');this.options_elem=this.elem.children(".options");this.elem.append(c);this.sidebar_elem=c;this.elem.addClass(this.options.subAlign);this.setOptionsWidth();a(window).resize(function(a){b.setOptionsWidth()});this.floatSidebar()},floatSidebar:function(){if(!this.options.floatSub||!this.options.subAlign.match(/left|right/)){return}var b=this;var c=this.sidebar_elem;var d=a(window);var e=a("html");var f=20;var g=c.offset();var h=a.extend({},g);var i=c.parent();var j=i.width();var k=i.offset().left;d.on("resize",function(a){var b=i.width()-j;var c=i.offset().left-k;h.left=g.left+b+c;d.trigger("scroll")});d.on("scroll",function(a){var b=d.scrollTop();var e=b-g.top;var j=c.outerHeight();var k=i.height();var l=k-j-f;if(e>-f){if(e<l-f){c.removeClass("bottom");c.addClass("fixed");c.css({left:h.left,top:f+"px"})}else{c.addClass("bottom");c.removeClass("fixed");c.css({top:l+"px",left:0})}}else{c.removeClass("fixed bottom");c.css({top:0,left:0})}})},setOptionsWidth:function(){var a=this.elem.outerWidth();var b=this.sidebar_elem.outerWidth();var c=a-b-21;this.options_elem.width(c)},calculateTotal:function(){var b=0;var c=this;var d=this.getSelectedElements();b=c.calculateTotalFor(d);var e=this.getQuantityElements();e.each(function(e){var f=a(this);var g=parseFloat(f.val()||1,10);if(g===1){return true}var h=f.attr("data-quantity").split(",");h=a.map(h,function(a,b){a=a.replace("[","\\[");a=a.replace("]","\\]");return"#"+a+',[name="'+a+'"]'}).join(",");var i=d.filter(h);var j=c.calculateTotalFor(i);b+=(g-1)*j});return b},calculateTotalFor:function(b){var c=this;var d=0;b.each(function(b){var e=a(this);d+=c.getPrice(e)});return d},getQuantityElements:function(){return this.options_elem.find(":input[data-quantity]")},getSelectedElements:function(){var b=a();var c=this;this.inputs.each(function(d){var e=a(this);if(c.canInputBeChecked(e)){if(!e.is(":checked")){return true}}b=b.add(e)});return b},canInputBeChecked:function(a){return a.is(":radio")||a.is(":checkbox")}};a.fn.jPrice=function(c){return this.each(function(){var d=a(this);if(d.data("jprice")){return}var e=new b(d,c);d.data("jprice",e)})};a.fn.bPrice=a.fn.jPrice;a.fn.jPrice.defaults={floatSub:false,subSelector:"",subAlign:"right",showPrices:true,showPricesOption:true,showZeroAs:"",signBefore:"$",signAfter:" AUD",pricesFadeTime:600,itemize:false,items:[],decimalSep:".",thousandsSep:",",emptySummaryText:"<p>Please configure your order...</p>",pricesOverPeriod:[]}})(jQuery)